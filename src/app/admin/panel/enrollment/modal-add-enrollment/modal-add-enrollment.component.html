<ng-template #modalAddEnrollment let-modal>
  <div class="modal-header bg-white border-bottom px-4">
    <h4 class="modal-title fw-semibold text-dark mb-0">Añadir inscripción manualmente</h4>
    <button 
      type="button" 
      class="btn-close" 
      aria-label="Close"
      (click)="onCancel()">
    </button>
  </div>

  <div class="modal-body bg-white p-4">
    <form [formGroup]="formAddEnrollment" (ngSubmit)="addEnrollment()" id="formAddEnrollment">
      <!-- DATOS DEL ESTUDIANTE -->
      <div class="section-divider">
        <h5 class="fw-semibold mb-0">Datos del Estudiante</h5>
      </div>

      <!-- Fila 1: Nombres y Apellidos -->
      <div class="row mb-3">
        <div class="col-md-4">
          <label class="form-label fw-medium small">Nombres *</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Nombre"
            formControlName="studentNames"
            name="studentFirstName">
        </div>
        <div class="col-md-4">
          <label class="form-label fw-medium small">Apellido Paterno *</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Apellido Paterno"
            formControlName="studentPaternalSurname"
            name="studentPaternalLastName">
        </div>
        <div class="col-md-4">
          <label class="form-label fw-medium small">Apellido Materno *</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Apellido Materno"
            formControlName="studentMaternalSurname"
            name="studentMaternalLastName">
        </div>
      </div>

      <!-- Fila 2: Documento, Fecha y Sexo -->
      <div class="row mb-3">
        <div class="col-md-3">
          <label class="form-label fw-medium small">Tipo de Documento *</label>
          <select 
            class="form-select rounded" 
            formControlName="studentTypeOfDocument"
            name="studentDocumentType">
            <option value="" disabled selected>Tipo de Documento</option>
            <option value="DNI">DNI</option>
            <option value="Carnet de extranjería">Carnet de extranjería</option>
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label fw-medium small">N° documento *</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Nro Documento"
            formControlName="studentDocumentNumber"
            name="studentDocumentNumber">
        </div>
        <div class="col-md-3">
          <label class="form-label fw-medium small">Fecha de Nacimiento *</label>
          <input 
            type="date" 
            class="form-control rounded"
            formControlName="studentBirthDate"
            name="studentBirthDate">
        </div>
        <div class="col-md-3">
          <label class="form-label fw-medium small">Género *</label>
          <select 
            class="form-select rounded"
            formControlName="studentGender"
            name="studentGender">
            <option value="" disabled selected>Género</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
          </select>
        </div>
      </div>

      <!-- Fila 3: Contacto -->
      <div class="row mb-4">
        <div class="col-md-4">
          <label class="form-label fw-medium small">Celular</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Celular"
            formControlName="studentPhoneNumber"
            name="studentPhone">
        </div>
        <div class="col-md-4">
          <label class="form-label fw-medium small">Dirección</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Dirección"
            formControlName="studentAdress"
            name="studentAddress">
        </div>
        <div class="col-md-4">
          <label class="form-label fw-medium small">Correo Personal</label>
          <input 
            type="email" 
            class="form-control rounded" 
            placeholder="Correo Personal"
            formControlName="studentEmail"
            name="studentEmail">
        </div>
      </div>

      <!-- NIVEL ACADÉMICO -->
      <div class="section-divider">
        <h5 class="fw-semibold mb-0">Nivel académico</h5>
      </div>

      <div class="row mb-4">
        <div class="col-md-6">
          <label class="form-label fw-medium small">Nivel *</label>
          <select 
            class="form-select rounded"
            name="academicLevel"
            (change)="selectedLevelId = +$any($event.target).value"
            >
            <option value="" disabled selected>Nivel</option>
            @for (level of levels; track level.id) {
              <option [value]="level.id">{{ level.name }}</option>
            }
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label fw-medium small">Grado *</label>
          <select 
            class="form-select rounded" 
            formControlName="grade"
            name="academicGrade">
            <option value="" disabled>Grado</option>
            @for (grade of filteredGrades; track grade.id) {
              <option [value]="grade.id">{{ grade.name }}</option>
            }
          </select>
        </div>
      </div>

      <!-- DATOS DEL APODERADO -->
      <div class="section-divider">
        <h5 class="fw-semibold mb-0">Datos del Apoderado</h5>
      </div>

      <!-- Fila 1: Nombres y Apellidos del Apoderado -->
      <div class="row mb-3">
        <div class="col-md-4">
          <label class="form-label fw-medium small">Nombres *</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Nombre"
            formControlName="tutorNames"
            name="guardianFirstName">
        </div>
        <div class="col-md-4">
          <label class="form-label fw-medium small">Apellido Paterno *</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Apellido Paterno"
            formControlName="tutorPaternalSurname"
            name="guardianPaternalLastName">
        </div>
        <div class="col-md-4">
          <label class="form-label fw-medium small">Apellido Materno *</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Apellido Materno"
            formControlName="tutorMaternalSurname"
            name="guardianMaternalLastName">
        </div>
      </div>

      <!-- Fila 2: Documento, Fecha y Sexo del Apoderado -->
      <div class="row mb-3">
        <div class="col-md-3">
          <label class="form-label fw-medium small">Tipo de Documento *</label>
          <select 
            class="form-select rounded" 
            formControlName="tutorTypeOfDocument"
            name="guardianDocumentType">
            <option value="" disabled selected>Tipo de Documento</option>
            <option value="DNI">DNI</option>
            <option value="Carnet de extranjería">Carnet de extranjería</option>
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label fw-medium small">N° documento *</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Nro Documento"
            formControlName="tutorDocumentNumber"
            name="guardianDocumentNumber">
        </div>
        <div class="col-md-3">
          <label class="form-label fw-medium small">Fecha de Nacimiento *</label>
          <input 
            type="date" 
            class="form-control rounded"
            formControlName="tutorBirthDate"
            name="guardianBirthDate">
        </div>
        <div class="col-md-3">
          <label class="form-label fw-medium small">Género</label>
          <select 
            class="form-select rounded" 
            formControlName="tutorGender"
            name="guardianGender">
            <option value="" selected disabled>Género</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
          </select>
        </div>
      </div>

      <!-- Fila 3: Contacto del Apoderado -->
      <div class="row mb-4">
        <div class="col-md-4">
          <label class="form-label fw-medium small">Celular</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Celular"
            formControlName="tutorPhoneNumber"
            name="guardianPhone">
        </div>
        <div class="col-md-4">
          <label class="form-label fw-medium small">Dirección</label>
          <input 
            type="text" 
            class="form-control rounded" 
            placeholder="Dirección"
            formControlName="tutorAdress"
            name="guardianAddress">
        </div>
        <div class="col-md-4">
          <label class="form-label fw-medium small">Correo Personal</label>
          <input 
            type="email" 
            class="form-control rounded" 
            placeholder="Correo Personal"
            formControlName="tutorEmail"
            name="guardianEmail">
        </div>
      </div>
    </form>
  </div>

  <div class="modal-footer bg-white border-top d-flex justify-content-end gap-2 p-3">
    <button 
      type="button" 
      class="btn btn-secondary rounded px-4"
      (click)="onCancel()">
      Cancelar
    </button>
    <button 
      type="submit" 
      class="btn btn-success rounded px-4"
      form="formAddEnrollment"
      [disabled]="formAddEnrollment.invalid"
      >
      Añadir Inscripción
    </button>
  </div>
</ng-template>
